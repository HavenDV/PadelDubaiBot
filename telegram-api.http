@TELEGRAM_BOT_TOKEN={{$dotenv TELEGRAM_BOT_TOKEN}}
@NEXT_PUBLIC_APP_URL={{$dotenv NEXT_PUBLIC_APP_URL}}
@PRODUCTION_APP_URL={{$dotenv PRODUCTION_APP_URL}}

### Set Production Webhook
GET https://api.telegram.org/bot{{TELEGRAM_BOT_TOKEN}}/setWebhook?url={{PRODUCTION_APP_URL}}api/telegram/webhook

### Set Webhook
GET https://api.telegram.org/bot{{TELEGRAM_BOT_TOKEN}}/setWebhook?url={{NEXT_PUBLIC_APP_URL}}api/telegram/webhook

### Get Webhook Info
GET https://api.telegram.org/bot{{TELEGRAM_BOT_TOKEN}}/getWebhookInfo

### Test telegram bot API locally

POST http://localhost:3000/api/telegram/webhook
Content-Type: application/json

{
  "message": {
    "chat": {
      "id": -123456789
    },
    "message_id": 123,
    "text": "@padel_dubai_bot tell me something"
  }
}

### Test skill level registration (will go to main list)
POST http://localhost:3000/api/telegram/webhook
Content-Type: application/json

{
  "callback_query": {
    "id": "test_callback_id",
    "from": {
      "id": 123456,
      "username": "testuser",
      "first_name": "Test"
    },
    "message": {
      "chat": {
        "id": -123456789
      },
      "message_id": 456,
      "text": "üéæ –í—Ç–æ—Ä–Ω–∏–∫, 07.01, 8:00-09:30\n\nüìç –ú–µ—Å—Ç–æ: SANDDUNE PADEL CLUB Al Qouz\nüíµ –¶–µ–Ω–∞: 65 aed/—á–µ–ª\nüèüÔ∏è –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–æ –∫–æ—Ä—Ç–æ–≤: 2\n\n–ó–∞–ø–∏—Å–∞–≤—à–∏–µ—Å—è –∏–≥—Ä–æ–∫–∏:"
    },
    "data": "skill_D+"
  }
}

### Test registration when game is full (will go to waitlist)
POST http://localhost:3000/api/telegram/webhook
Content-Type: application/json

{
  "callback_query": {
    "id": "test_callback_id_2",
    "from": {
      "id": 123457,
      "username": "fifthplayer",
      "first_name": "Fifth"
    },
    "message": {
      "chat": {
        "id": -123456789
      },
      "message_id": 456,
      "text": "üéæ –í—Ç–æ—Ä–Ω–∏–∫, 07.01, 8:00-09:30\n\nüìç –ú–µ—Å—Ç–æ: SANDDUNE PADEL CLUB Al Qouz\nüíµ –¶–µ–Ω–∞: 65 aed/—á–µ–ª\nüèüÔ∏è –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–æ –∫–æ—Ä—Ç–æ–≤: 2\n\n–ó–∞–ø–∏—Å–∞–≤—à–∏–µ—Å—è –∏–≥—Ä–æ–∫–∏:\n\n1. @player1 (D+)\n2. @player2 (D)\n3. @player3 (D+)\n4. @player4 (C-)"
    },
    "data": "skill_D"
  }
}

### Test cancellation from main game (will move waitlist player to main game + notification)
POST http://localhost:3000/api/telegram/webhook
Content-Type: application/json

{
  "callback_query": {
    "id": "test_callback_id_3",
    "from": {
      "id": 123458,
      "username": "player2",
      "first_name": "Player2"
    },
    "message": {
      "chat": {
        "id": -123456789
      },
      "message_id": 456,
      "text": "üéæ –í—Ç–æ—Ä–Ω–∏–∫, 07.01, 8:00-09:30\n\nüìç –ú–µ—Å—Ç–æ: SANDDUNE PADEL CLUB Al Qouz\nüíµ –¶–µ–Ω–∞: 65 aed/—á–µ–ª\nüèüÔ∏è –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–æ –∫–æ—Ä—Ç–æ–≤: 2\n\n–ó–∞–ø–∏—Å–∞–≤—à–∏–µ—Å—è –∏–≥—Ä–æ–∫–∏:\n\n1. @player1 (D+)\n2. @player2 (D)\n3. @player3 (D+)\n4. @player4 (C-)\n\n‚è≥ Waitlist:\n1. @fifthplayer (D)"
    },
    "data": "skill_not_coming"
  }
}

### Test cancellation from waitlist (no notification)
POST http://localhost:3000/api/telegram/webhook
Content-Type: application/json

{
  "callback_query": {
    "id": "test_callback_id_4",
    "from": {
      "id": 123459,
      "username": "fifthplayer",
      "first_name": "Fifth"
    },
    "message": {
      "chat": {
        "id": -123456789
      },
      "message_id": 456,
      "text": "üéæ –í—Ç–æ—Ä–Ω–∏–∫, 07.01, 8:00-09:30\n\nüìç –ú–µ—Å—Ç–æ: SANDDUNE PADEL CLUB Al Qouz\nüíµ –¶–µ–Ω–∞: 65 aed/—á–µ–ª\nüèüÔ∏è –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–æ –∫–æ—Ä—Ç–æ–≤: 2\n\n–ó–∞–ø–∏—Å–∞–≤—à–∏–µ—Å—è –∏–≥—Ä–æ–∫–∏:\n\n1. @player1 (D+)\n2. @player2 (D)\n3. @player3 (D+)\n4. @player4 (C-)\n\n‚è≥ Waitlist:\n1. @fifthplayer (D)\n2. @sixthplayer (D+)"
    },
    "data": "skill_not_coming"
  }
}

### Test weekly schedule creation

GET http://localhost:3000/api/telegram/create-poll